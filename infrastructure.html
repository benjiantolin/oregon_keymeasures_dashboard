<!DOCTYPE html>
<html lang="en">
<head>
    <title>ObtC Infrastructure Measures</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Oregon by the Counties"/>
    <meta property="og:url" content="http://benjiantolin.github.io/oregon_keymeasures_dashboard/index.html"/>
    <meta property="og:description" content="This is a storymap using sample measures from Oregon by the Numbers."/>


    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">


    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/oregon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo|Lato" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">
    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--chroma.js-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>
</head>
<body>

<div id="storymap" class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="assets/oregon_scenery.mp4">
                <div class="fullscreen text-center">
                  <div class="row justify-content-center align-items-center">
                    <span style="font-size: 2rem;">
                      <a href="index.html"><i class="fas fa-home"></i></a>
                      <a href="demographic.html"><i class="fas fa-users"></i></a>
                      <a href="social.html"><i class="fas fa-shopping-basket"></i></a>
                      <a href="economic.html"><i class="fas fa-chart-line"></i></a>
                      <a href="education.html"><i class="fas fa-user-graduate"></i></a>
                      <a href="health.html"><i class="fas fa-medkit"></i></a>
                      <a href="infrastructure.html"><i class="fas fa-road"></i></a>
                  </span>
                  </div>
                    <h1 class="display-4 d-flex justify-content-center">Infrastructure Measures</h1>
                    <h3 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <i>Oregon by the Counties</i>
                    </h3>
                </div>
            </section>
            <section data-scene="broadband">
              <h2>Broadband Access</h2>
              <h5><i><b>Definition:</b>The percentage of households served by broadband
                                       internet (25 Mbps download/3 Mbps upload).</i></h5>
              <p>The internet has changed the way people access information, shop,
                 work and view entertainment. Today, access to high volume data
                 transfer rates has become a key requirement for economic and
                 community development. Access to broadband is determined by
                 the advanced telecommunications capability benchmark as defined
                 by the FCC. The existing benchmark speed is 25 Mbps download/3
                 Mbps upload.</P>
              <p>To calculate the percentage of households served by
                 broadband, census blocks were analyzed to see if they met the FCC’s
                 advanced broadband benchmark. Households in census blocks that met
                 the FCC’s advanced broadband criteria households were aggregated
                 and then divided by the total number of households in a county to
                 calculate the percentage of households served by broadband internet.</p>
              <p>It is important to recognize that while broadband may be available
                 for a household to purchase, the cost may prohibit having an actual
                 broadband subscription. This measure shows only the percentage of
                 households that could have broadband access.</p>
            </section>

            <section data-scene="transit">
              <h2>Transit Service</h2>
              <h5><i><b>Definition:</b>The percentage of residents served by public transit
                                       service, measured as the unduplicated population within a .25-mile
                                       radius of a given stop operated by a transit agency.</i></h5>
              <p>Public transit is an essential service for those who do not or cannot
                 drive. It allows individuals without a private means of transportation
                 to remain connected in their communities, reach jobs, access medical
                 care and meet other basic needs.</p>
              <p>Public transit is particularly important
                 in rural communities where travel distances to services are greater,
                 thereby making alternatives, such as bicycles, generally impractical for
                 most residents.</p>
            </section>

            <section data-scene="vmt">
              <h2>Vehicle Miles Traveled</h2>
              <h5><i><b>Definition:</b>The sum of distances traveled by all motor vehicles in a
                                       specified system of highways for a given period of time. Each road
                                       section is calculated by multiplying the average daily traffic by the
                                       length of the road section and the length of the time period. The
                                       Vehicle Miles Traveled (VMT) for those sections are summed to
                                       calculate the VMT for a road or road system. Values are presented
                                       in millions.</i></h5>
              <p>Historically, vehicle miles traveled has been closely related to
                 economic productivity. As the income and population increase, there
                 is a corresponding increase in trips to access goods and services,
                 and an increase in commercial traffic.</p>
              <p>Furthermore, VMT may be a
                 consideration in planning and maintenance of road infrastructure, as
                 well as treating vehicle-related pollution.</p>
            </section>

            <section data-scene="devland">
              <h2>Developed or Cultivated Land</h2>
              <h5><i><b>Definition:</b>The percentage of total land cover classified as
                                       developed or cultivated (includes pasture) according to the National
                                       Land Cover Database.</i></h5>
              <p>This measure tracks the conversion and designation of land for human
                 purposes. This shift changes the provision of ecosystem services such
                 as climate regulation, natural hazard regulation, water purification
                 and waste management, pollination or pest control. It also can indicate
                 economic growth in a county</p>
            </section>

            <section data-scene="mobilehome">
              <h2>Mobile Homes</h2>
              <h5><i><b>Definition:</b>The percentage of housing units reported as
                                       mobile homes.</i></h5>
              <p>Mobile homes are an often maligned but important source of affordable
                 housing. They represent the largest segment of non-subsidized
                 affordable housing in the United States. These homes, whether single
                 or double wide, provide low-cost housing for millions of Americans,
                 who most often own their mobile home and lease the land it sits on.</p>
              <p>While mobile homes do present a range of challenges, they also provide
                 housing opportunities for individuals and families experiencing
                 economic hardship, and they have the potential to develop microcommunities
                 when mobile housing is clustered in park</p>
            </section>

            <section data-scene="end" data-background="img/mthood.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">For more infromation about Oregon and its counties visit:</h1>
                    <h4 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a>
                    </h4>
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn"
               href="https://facebook.com/sharer.php?u=http://benjiantolin.github.io/oregon_keymeasures_dashboard/index.html"
               target="_blank"></a>
        </dt>
        <dt>
            <!--github icon-->
            <a class="fab fa-github btn" href="https://github.com/benjiantolin/oregon_keymeasures_dashboard" style="top:40px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:60px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                  <p>This is a story map that contains a sample of key measures borrowed from the <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a> report.
                    <br><br>
                    A handful of the key measures provided in the report are further visualize the data using a
                    dynamic online interface. The goal of report is to get information to local community leaders, to
                    encorage data driven decision making.
                    <br><br>
                    This story map further extends the vision by creating an online interactive platform to visualize and analyze the key measures for Oregon counties.</p>
                  <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                  <p><b>Author: Benjamin Antolin</b>| Oregon State University
                  </p>
                  <p>The <a href="https://youtu.be/V2vwFS8ae2I">background video</a> on the front page
                      was clipped from Youtube. </p>
                  <p>The context and data about key measures was collected from the Oregon by the Numbers 2018 Edition Report.</p>
                  <p>The favicon image was acquired from <a href="https://en.wikipedia.org/wiki/List_of_Oregon_state_symbols">Wikipedia</a></p>
                  <p>This story map uses geospatial data from cartodb and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">

var colors = chroma.scale('PuRd').colors(5);
    //////////////////////////////////////////////////////////////////////////
    // Scene 2: Broadband Access
    // Set function for color ramp
    function setColor1(density){
        //Tenary operation: condition ? valueIfTrue : valueIfFalse
        // condition ? value1 : value2
        var id = 0;
        if (density > 89.6) { id = 4; }
        else if (density > 78.39 && density <= 89.6) { id = 3; }
        else if (density > 62.09 &&  density <= 78.39) { id = 2; }
        else if (density > 6.54 && density <= 62.09) { id = 1; }
        else  { id = 0; }
        return colors[id];
    }

    // Set style function that sets fill color property equal to Total Population
    function style1(feature) {
        return {
            fillColor: setColor1(feature.properties.broadband),
            fillOpacity: 0.5,
            weight: 2,
            opacity: 0.8,
            color: '#605f5f',
            dashArray: '4'
        };
    }

    var counties_broadband = L.geoJson.ajax('assets/counties.geojson',
        {
            style: style1,
            onEachFeature: function (feature, layer) {
                layer.bindTooltip(feature.properties.NAME+"<br> Broadband Access: "+ feature.properties.broadband.toFixed(2) +"%" , {className: 'feature-label', permanent: false, direction: 'center'});
            }
        });


    var counties_broadband_legend = '<p><b>% Broadband Access</b></p>' +
        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>89.6</b></p>' +
        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>78.39-89.6</b></p>' +
        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>62.09-78.38</b></p>' +
        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>6.54-62.08</b></p>' +
        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b></b><6.54</p>';



        //////////////////////////////////////////////////////////////////////////
        // Scene 3: Transit Service

        // Set function for color ramp
        function setColor2(density){
            //Tenary operation: condition ? valueIfTrue : valueIfFalse
            // condition ? value1 : value2
            var id = 0;
            if (density > 47.72) { id = 4; }
            else if (density > 35.98 && density <= 47.72) { id = 3; }
            else if (density > 25.96 &&  density <= 35.98) { id = 2; }
            else if (density > 11.97 && density <= 25.96) { id = 1; }
            else  { id = 0; }
            return colors[id];
        }

        // Set style function that sets fill color property equal to percentage of rural population
        function style2(feature) {
            return {
                fillColor: setColor2(feature.properties.transit),
                fillOpacity: 0.5,
                weight: 2,
                opacity: 0.8,
                color: '#605f5f',
                dashArray: '4'
            };
        }

        var counties_transit = L.geoJson.ajax('assets/counties.geojson',
            {
                style: style2,
                onEachFeature: function (feature, layer) {
                    layer.bindTooltip(feature.properties.NAME+"<br> Transit Service: "+ (feature.properties.transit).toFixed(2) + "%", {className: 'feature-label', permanent: false, direction: 'center'});
                }
            });


        var counties_transit_legend = '<p><b>Transit Service (%)</b></p>' +
        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>47.72</b></p>' +
        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>35.98-47.72</b></p>' +
        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>25.96-35.98</b></p>' +
        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>11.97-25.95</b></p>' +
        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><11.96</b></p>';

            //////////////////////////////////////////////////////////////////////////
            // Scene 4: Vehicle Miles Traveled

            // Set function for color ramp
            function setColor3(density){
                //Tenary operation: condition ? valueIfTrue : valueIfFalse
                // condition ? value1 : value2
                var id = 0;
                if (density > 1612700000) { id = 4; }
                else if (density > 721200000 && density <= 1612700000) { id = 3; }
                else if (density > 375000000 &&  density <= 721200000) { id = 2; }
                else if (density > 172900000 && density <= 375000000) { id = 1; }
                else  { id = 0; }
                return colors[id];
            }

            // Set style function that sets fill color property equal to net migration
            function style3(feature) {
                return {
                    fillColor: setColor3(feature.properties.vmt),
                    fillOpacity: 0.5,
                    weight: 2,
                    opacity: 0.8,
                    color: '#605f5f',
                    dashArray: '4'
                };
            }

            var counties_vmt = L.geoJson.ajax('assets/counties.geojson',
                {
                    style: style3,
                    onEachFeature: function (feature, layer) {
                        layer.bindTooltip(feature.properties.NAME+"<br> Vehicle Miles Traveled: "+ (feature.properties.vmt), {className: 'feature-label', permanent: false, direction: 'center'});
                    }
                });


            var counties_vmt_legend = '<p><b>Vehicle Miles Traveled</b></p>' +
                '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>1,612,700,000</b></p>' +
                '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>721,200,001-1,612,700,000</b></p>' +
                '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b></b>375,000,001-721,200,000</p>' +
                '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>172,900,000-375,000,000</b></p>'+
                '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><172,900,000</b></p>';

                // Scene 5: Developed or Cultivated Land


                    // Set function for color ramp
                    function setColor4(density){
                        //Tenary operation: condition ? valueIfTrue : valueIfFalse
                        // condition ? value1 : value2
                        var id = 0;
                        if (density > 33.25) { id = 4; }
                        else if (density > 14.66 && density <= 33.25) { id = 3; }
                        else if (density > 9.08 &&  density <= 14.66) { id = 2; }
                        else if (density > 5.27 && density <= 9.08) { id = 1; }
                        else  { id = 0; }
                        return colors[id];
                    }

                    // Set style function that sets fill color property equal to the housing cost burden
                    function style4(feature) {
                        return {
                            fillColor: setColor4(feature.properties.devland),
                            fillOpacity: 0.5,
                            weight: 2,
                            opacity: 0.8,
                            color: '#605f5f',
                            dashArray: '4'
                        };
                    }

                    var counties_devland = L.geoJson.ajax('assets/counties.geojson',
                        {
                            style: style4,
                            onEachFeature: function (feature, layer) {
                                layer.bindTooltip(feature.properties.NAME+"<br> Developed or Cultivated Land: "+ (feature.properties.devland).toFixed(2)+ "%", {className: 'feature-label', permanent: false, direction: 'center'});
                            }
                        });


                    var counties_devland_legend = '<p><b>Developed or Cultivated Land</b></p>' +
                        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>33.25</b></p>' +
                        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>14.66-33.25</b></p>' +
                        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>9.08-14.65</b></p>' +
                        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>5.27-9.07</b></p>'+
                        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><5.27</b></p>';

                //////////////////////////////////////////////////////////////////////////
                // Scene 6: Mobile Homes


                    // Set function for color ramp
                    function setColor5(density){
                        //Tenary operation: condition ? valueIfTrue : valueIfFalse
                        // condition ? value1 : value2
                        var id = 0;
                        if (density > 19.91) { id = 4; }
                        else if (density > 15.52 && density <= 19.91) { id = 3; }
                        else if (density > 11.82 &&  density <= 15.52) { id = 2; }
                        else if (density > 7.42 && density <= 11.82) { id = 1; }
                        else  { id = 0; }
                        return colors[id];
                    }

                    // Set style function that sets fill color property equal to the housing cost burden
                    function style5(feature) {
                        return {
                            fillColor: setColor5(feature.properties.mobilehome),
                            fillOpacity: 0.5,
                            weight: 2,
                            opacity: 0.8,
                            color: '#605f5f',
                            dashArray: '4'
                        };
                    }

                    var counties_mobilehome = L.geoJson.ajax('assets/counties.geojson',
                        {
                            style: style5,
                            onEachFeature: function (feature, layer) {
                                layer.bindTooltip(feature.properties.NAME+"<br> Mobile Homes: "+ (feature.properties.mobilehome)+ "%", {className: 'feature-label', permanent: false, direction: 'center'});
                            }
                        });


                    var counties_mobilehome_legend = '<p><b>Mobile Homes (%)</b></p>' +
                        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>19.91</b></p>' +
                        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>15.52-19.91</b></p>' +
                        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>11.82-15.51</b></p>' +
                        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>7.42-11.81</b></p>'+
                        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><7.41</b></p>';

                //////////////////////////////////////////////////////////////////////////
    var layers = {

        counties_broadband: {
            layer: counties_broadband, legend: counties_broadband_legend
        },
        counties_transit: {
            layer: counties_transit, legend: counties_transit_legend
        },
        counties_vmt: {
            layer: counties_vmt, legend: counties_vmt_legend
        },
        counties_devland: {
            layer: counties_devland, legend: counties_devland_legend
        },
        counties_mobilehome: {
            layer: counties_mobilehome, legend: counties_mobilehome_legend
        },

        cartodb_light: {layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png')}
    };

    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        broadband: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Broadband Access', layers: [layers.counties_broadband]},
        transit: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Transit Service', layers: [layers.counties_transit]},
        vmt: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Vehicle Miles Traveled', layers: [layers.counties_vmt]},
        devland: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Developed & Cultivated Lands', layers: [layers.counties_devland]},
        mobilehome: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: '% Mobile Homes', layers: [layers.counties_mobilehome]},
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'The End'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.cartodb_light,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "Data & Content: Oregon by the Numbers 2018 | Basemap: CartoDB &copy; | Video: Morissey Productions | Created by Benji Antolin |",
        loader: true,
        scalebar: false,
        flyo: true,
        navwidget: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);

            //add an miniglobe
            new L.Control.GlobeMiniMap({
                marker: 'red',
                position: 'bottomright'
            }).addTo(map);


            return map;
        }
    });
</script>
</body>
</html>
