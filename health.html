<!DOCTYPE html>
<html lang="en">
<head>
    <title>Oregon by the Counties</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Oregon by the Counties"/>
    <meta property="og:url" content="http://benjiantolin.github.io/obtcstorymap/index.html"/>
    <meta property="og:description" content="This is a storymap using sample measures from Oregon by the Numbers."/>


    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">


    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/oregon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo|Lato" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">
    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>
</head>
<body>

<div id="storymap" class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="assets/oregon_scenery.mp4">
                <div class="fullscreen text-center">
                  <div class="row justify-content-center align-items-center">
                    <span style="font-size: 2rem;">
                      <a href="index.html"><i class="fas fa-home"></i></a>
                      <a href="demographic.html"><i class="fas fa-users"></i></a>
                      <a href="social.html"><i class="fas fa-shopping-basket"></i></a>
                      <a href="economic.html"><i class="fas fa-chart-line"></i></a>
                      <a href="education.html"><i class="fas fa-user-graduate"></i></a>
                      <a href="health.html"><i class="fas fa-medkit"></i></a>
                      <a href="infrastructure.html"><i class="fas fa-road"></i></a>
                  </span>
                  </div>
                    <h1 class="display-4 d-flex justify-content-center">Health Measures</h1>
                    <h3 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <i>Oregon by the Counties</i>
                    </h3>
                </div>
            </section>
            <section data-scene="totpop">
              <h2>Physically Active Adults</h2>
              <h5><i><b>Definition:</b>The percentage of adults who report meeting the
                                       guidelines for physical activity provided by the Centers for Disease
                                       Control and Prevention (CDC). They are: 150 minutes per week of
                                       moderate-intensity activity or 75 minutes per week of vigorousintensity activity, or a combination AND muscle-strengthening
                                       activities for all major muscle groups at least two days per week.</i></h5>
              <p>The data comprising this measure are from aggregated sampling across
                 years. Low physical activity has been associated with several disease
                 conditions such as Type 2 diabetes, cancer, stroke, hypertension,
                 cardiovascular disease and premature mortality, independent of
                 obesity.</P>
              <p>Being physically active has a positive impact on mental as well
                 as physical health. Adults who are physically active tend to encourage
                 activity in their children as well, potentially reducing health costs for
                 multiple generations.</p>
            </section>

            <section data-scene="ruralpop">
              <h2>Adult Smoking</h2>
              <h5><i><b>Definition:</b>The percentage of adults who report that they currently
                                       smoke cigarettes. </i></h5>
              <p>Data are from aggregated sampling across years. Smoking is one of the
                 most preventable causes of disease and death. The effects of smoking
                 can increase the risk of cancer, heart disease and respiratory diseases
                 for smokers themselves as well as their family members. </p>
            </section>

            <section data-scene="netmigrate">
              <h2>Healthy Diet</h2>
              <h5><i><b>Definition:</b>The percentage of adults who report eating the
                                       recommended amounts of fruits and vegetables, meaning five or
                                       more servings of fruits and vegetables per day. </i></h5>
              <p>Data are from aggregated sampling across years. Fruits and vegetables
                 contain vitamins, minerals and fiber that are all essential to a healthy
                 diet. Benefits of a healthy diet include decreased risk of chronic
                 diseases, hypertension, cancer, obesity and micronutrient deficiencies.
                 Good nutrition is also associated with mental health benefits. </p>
            </section>

            <section data-scene="hcb">
              <h2>Vaccination Rate, Two-Year-Olds</h2>
              <h5><i><b>Definition:</b>The percentage of two-year-olds in a given year
                                       who have received their required immunizations â€“ rates of 95%
                                       or greater are suppressed to 95% to prevent identification of
                                       individuals.</i> </h5>
              <p>In Oregon, children entering preschool, child care or Head Start
                 currently must receive: four doses Diphtheria/Tetanus/Pertussis
                 (DTaP); three Polio; one Varicella (chickenpox); one Measles/Mumps/
                 Rubella (MMR); three Hepatitis B; two Hepatitis A; and three or four
                 Hib (Haemophilus).</p>
              <p>Vaccines have prevented countless cases of disease
                 and saved millions of lives. The economic impact of prevented disease
                 due to vaccines and the foregone cost of treatment is significant when
                 compared to vaccination costs.</p>
            </section>

            <section data-scene="lowweight">
              <h2>Low Weight Births</h2>
              <h5><i><b>Definition:</b>The percentage of live babies who weigh less than
                                       2,500 grams (5.5 lbs) at birth.</i> </h5>
              <p>Low weight births indicate risk factors for both child and maternal
                 health. For the child, low birth weight is a predictor of premature
                 morbidity and death, risk for developmental problems, and respiratory
                 and cardiovascular disease later in life. For the mother, low birth weight
                 indicates a number of concerns including adverse health behavior,
                 limited access to care, socioeconomic and environmental risks. </p>
            </section>

            <section data-scene="end" data-background="img/mthood.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">For more infromation about Oregon and its counties visit:</h1>
                    <h4 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a>
                    </h4>
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn"
               href="https://facebook.com/sharer.php?u=http://benjiantolin.github.io/obtcstorymap/index.html"
               target="_blank"></a>
        </dt>
        <dt>
            <!--github icon-->
            <a class="fab fa-github btn" href="https://github.com/benjiantolin/obtcstorymap" style="top:40px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:60px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                  <p>This is a story map that contains a sample of key measures borrowed from the <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a> report.
                    <br><br>
                    A handful of the key measures provided in the report are further visualize the data using a
                    dynamic online interface. The goal of report is to get information to local community leaders, to
                    encorage data driven decision making.
                    <br><br>
                    This story map further extends the vision by creating an online interactive platform to visualize and analyze the key measures for Oregon counties.</p>
                  <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                  <p><b>Author: Benjamin Antolin</b>| Oregon State University
                  </p>
                  <p>The <a href="https://youtu.be/V2vwFS8ae2I">background video</a> on the front page
                      was clipped from Youtube. </p>
                  <p>The context and data about key measures was collected from the Oregon by the Numbers 2018 Edition Report.</p>
                  <p>The favicon image was acquired from <a href="https://en.wikipedia.org/wiki/List_of_Oregon_state_symbols">Wikipedia</a></p>
                  <p>This story map uses geospatial data from cartodb and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">

    //////////////////////////////////////////////////////////////////////////
    // Scene 2: Physically Active Adults
    // Set function for color ramp
    function setColor1(density){
        //Tenary operation: condition ? valueIfTrue : valueIfFalse
        // condition ? value1 : value2
        return  density > 32.01 ? '#b30000' :
                density > 25.91 ? '#e34a33' :
                density > 17.61 ? '#fc8d59' :
                density > 6.21 ? '#fdcc8a' :
                '#fef0d9';
    }

    // Set style function that sets fill color property equal to Total Population
    function style1(feature) {
        return {
            fillColor: setColor1(feature.properties.Total_Popu),
            fillOpacity: 0.5,
            weight: 2,
            opacity: 0.8,
            color: '#605f5f',
            dashArray: '4'
        };
    }

    var counties_totpop = L.geoJson.ajax('assets/counties.geojson',
        {
            style: style1,
            onEachFeature: function (feature, layer) {
                layer.bindTooltip(feature.properties.altName+"<br> Total Pop: "+ feature.properties.Total_Popu , {className: 'feature-label', permanent: false, direction: 'center'});
            }
        });


    var counties_totpop_legend = '<p><b>Total Population</b></p>' +
        '<i style="background: #fef0d9; opacity: 0.5"></i><p><b>0 - 37,660</b></p>' +
        '<i style="background: #fdcc8a; opacity: 0.5"></i><p><b>37,661 - 87,455</b></p>' +
        '<i style="background: #fc8d59; opacity: 0.5"></i><p><b>87,456 - 210,916</b></p>' +
        '<i style="background: #e34a33; opacity: 0.5"></i><p><b>210,917 - 564,088</b></p>' +
        '<i style="background: #b30000; opacity: 0.5"></i><p><b>>564,088</b></p>';



        //////////////////////////////////////////////////////////////////////////
        // Scene 3: Healthy Diet

        // Set function for color ramp
        function setColor2(density){
            //Tenary operation: condition ? valueIfTrue : valueIfFalse
            // condition ? value1 : value2
            return  density > 30.91 ? '#b30000' :
                    density > 22.61 ? '#e34a33' :
                    density > 14.61 ? '#fc8d59' :
                    density > 5.91 ? '#fdcc8a' :
                    '#fef0d9';
        }

        // Set style function that sets fill color property equal to percentage of rural population
        function style2(feature) {
            return {
                fillColor: setColor2(feature.properties.Rural_Popu),
                fillOpacity: 0.5,
                weight: 2,
                opacity: 0.8,
                color: '#605f5f',
                dashArray: '4'
            };
        }

        var counties_ruralpop = L.geoJson.ajax('assets/counties.geojson',
            {
                style: style2,
                onEachFeature: function (feature, layer) {
                    layer.bindTooltip(feature.properties.altName+"<br> Rural Pop: "+ (feature.properties.Rural_Popu).toFixed(2) + "%", {className: 'feature-label', permanent: false, direction: 'center'});
                }
            });


        var counties_ruralpop_legend = '<p><b>Rural Population</b></p>' +
            '<i style="background: #fef0d9; opacity: 0.5"></i><p><b>0% - 25%</b></p>' +
            '<i style="background: #fdcc8a; opacity: 0.5"></i><p><b>25.1% - 50%</b></p>' +
            '<i style="background: #fc8d59; opacity: 0.5"></i><p><b>50.1% - 75%</b></p>' +
            '<i style="background: #e34a33; opacity: 0.5"></i><p><b>75.1% - 100%</b></p>';

            //////////////////////////////////////////////////////////////////////////
            // Scene 4: Vaccination 2 year olds

            // Set function for color ramp
            function setColor3(density){
                //Tenary operation: condition ? valueIfTrue : valueIfFalse
                // condition ? value1 : value2
                return  density > 73.01 ? '#b30000' :
                        density > 67.01 ? '#e34a33' :
                        density > 51.01 ? '#fc8d59' :
                        density > 0.01 ? '#fdcc8a' :
                        '#fef0d9';
            }

            // Set style function that sets fill color property equal to net migration
            function style3(feature) {
                return {
                    fillColor: setColor3(feature.properties.Migration),
                    fillOpacity: 0.5,
                    weight: 2,
                    opacity: 0.8,
                    color: '#605f5f',
                    dashArray: '4'
                };
            }

            var counties_netmigrate = L.geoJson.ajax('assets/counties.geojson',
                {
                    style: style3,
                    onEachFeature: function (feature, layer) {
                        layer.bindTooltip(feature.properties.altName+"<br> Net Migration: "+ (feature.properties.Migration).toFixed(2), {className: 'feature-label', permanent: false, direction: 'center'});
                    }
                });


            var counties_netmigrate_legend = '<p><b>Net Migration</b></p>' +
                '<i style="background: #fef0d9; opacity: 0.5"></i><p><b>-7.18 - -2.93</b></p>' +
                '<i style="background: #fdcc8a; opacity: 0.5"></i><p><b>-2.92 - 3.19</b></p>' +
                '<i style="background: #fc8d59; opacity: 0.5"></i><p><b>3.20 - 7.77</b></p>' +
                '<i style="background: #e34a33; opacity: 0.5"></i><p><b>7.78 - 12.92</b></p>'+
                '<i style="background: #b30000; opacity: 0.5"></i><p><b>>12.93</b></p>';

                // Scene 5: Low Birth weight


                    // Set function for color ramp
                    function setColor4(density){
                        //Tenary operation: condition ? valueIfTrue : valueIfFalse
                        // condition ? value1 : value2
                        return  density > 11.77 ? '#b30000' :
                                density > 7.54 ? '#e34a33' :
                                density > 5.99 ? '#fc8d59' :
                                density > 2.16 ? '#fdcc8a' :
                                '#fef0d9';
                    }

                    // Set style function that sets fill color property equal to the housing cost burden
                    function style4(feature) {
                        return {
                            fillColor: setColor4(feature.properties.Housing_Co),
                            fillOpacity: 0.5,
                            weight: 2,
                            opacity: 0.8,
                            color: '#605f5f',
                            dashArray: '4'
                        };
                    }

                    var counties_hcb = L.geoJson.ajax('assets/counties.geojson',
                        {
                            style: style4,
                            onEachFeature: function (feature, layer) {
                                layer.bindTooltip(feature.properties.altName+"<br> Housing Cost Burden: "+ (feature.properties.Housing_Co).toFixed(2)+ "%", {className: 'feature-label', permanent: false, direction: 'center'});
                            }
                        });


                    var counties_hcb_legend = '<p><b>Housing Cost Burden</b></p>' +
                        '<i style="background: #fef0d9; opacity: 0.5"></i><p><b>23.02 - 26.77</b></p>' +
                        '<i style="background: #fdcc8a; opacity: 0.5"></i><p><b>26.78 - 31.16</b></p>' +
                        '<i style="background: #fc8d59; opacity: 0.5"></i><p><b>31.17 - 34.55</b></p>' +
                        '<i style="background: #e34a33; opacity: 0.5"></i><p><b>34.56 - 38.11</b></p>'+
                        '<i style="background: #b30000; opacity: 0.5"></i><p><b>>38.12</b></p>';

                //////////////////////////////////////////////////////////////////////////


    var layers = {
        ESRI: {layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}')},
        counties_totpop: {
            layer: counties_totpop, legend: counties_totpop_legend
        },
        counties_ruralpop: {
            layer: counties_ruralpop, legend: counties_ruralpop_legend
        },
        counties_netmigrate: {
            layer: counties_netmigrate, legend: counties_netmigrate_legend
        },
        counties_hcb: {
            layer: counties_hcb, legend: counties_hcb_legend
        },
        GEE: {
            layer: L.tileLayer('http://earthengine.google.org/static/hansen_2013/tree_alpha/{z}/{x}/{y}.png'),

        },
        satellite: {
            layer: L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
                id: 'mapbox.satellite'
            })
        },
        cartodb_light: {layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png')}
    };

    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        totpop: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Total Population', layers: [layers.counties_totpop]},
        ruralpop: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Rural Population', layers: [layers.counties_ruralpop]},
        netmigrate: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Net Migration', layers: [layers.counties_netmigrate]},
        hcb: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Housing Burden Cost', layers: [layers.counties_hcb]},
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'The End'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.cartodb_light,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "",
        loader: true,
        scalebar: false,
        flyo: true,
        navwidget: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);

            //add an miniglobe
            new L.Control.GlobeMiniMap({
                marker: 'red',
                position: 'bottomright'
            }).addTo(map);


            return map;
        }
    });
</script>
</body>
</html>
