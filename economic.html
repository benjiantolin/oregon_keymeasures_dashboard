<!DOCTYPE html>
<html lang="en">
<head>
    <title>ObtC Economic Measures</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Oregon by the Counties"/>
    <meta property="og:url" content="http://benjiantolin.github.io/oregon_keymeasures_dashboard/index.html"/>
    <meta property="og:description" content="This is a storymap using sample measures from Oregon by the Numbers."/>


    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">


    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/oregon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo|Lato" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">
    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--chroma.js-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>
</head>
<body>

<div id="storymap" class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="assets/oregon_scenery.mp4">
                <div class="fullscreen text-center">
                  <div class="row justify-content-center align-items-center">
                    <span style="font-size: 2rem;">
                      <a href="index.html"><i class="fas fa-home"></i></a>
                      <a href="demographic.html"><i class="fas fa-users"></i></a>
                      <a href="social.html"><i class="fas fa-shopping-basket"></i></a>
                      <a href="economic.html"><i class="fas fa-chart-line"></i></a>
                      <a href="education.html"><i class="fas fa-user-graduate"></i></a>
                      <a href="health.html"><i class="fas fa-medkit"></i></a>
                      <a href="infrastructure.html"><i class="fas fa-road"></i></a>
                  </span>
                  </div>
                    <h1 class="display-4 d-flex justify-content-center">Economic Measures</h1>
                    <h3 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <i>Oregon by the Counties</i>
                    </h3>
                </div>
            </section>
            <section data-scene="medinc">
              <h2>Median Income</h2>
              <h5><i><b>Definition:</b> The household income value at which 50% of
                                        households in the county earn less and 50% earn more.</i></h5>
              <p>Median household income in this report provides a measure of the
                 typical or “middle” income level in a county as well as the overall
                 economic wellbeing for residents. </P>
              <p>One key drawback is that this
                 measure treats all households equally regardless of the number of
                 people in the household. The size of the household has a big impact
                 on how the income is distributed to individuals. Nonetheless, median
                 household income remains a broadly used measure</p>
              <p>It is useful in tracking income growth, which is associated with the
                 ability of residents to meet their needs, and comparing economic conditions
                 across counties
              </p>
            </section>

            <section data-scene="unemprate">
              <h2>Unemployment Rate</h2>
              <h5><i><b>Definition:</b> The percentage of the population who do not have a job,
                                        are currently available for work and are actively seeking work.</i></h5>
              <p> Unemployment has an impact on the individuals who are without
                 work, their families and their communities. The purchasing power of
                 those workers is lost, as are the goods and services they might have
                 produced. People who are unemployed are also at a higher risk of
                 social challenges.</p>
              <p> The unemployment rate serves as both a measure
                 of labor availability and an overall indicator of a county’s economic
                 health. While labor availability is an important factor in economic
                 development, high rates of unemployment are considered unfavorable.</p>
            </section>

            <section data-scene="lfpr">
              <h2>Labor Force Participation Rate</h2>
              <h5><i><b>Definition:</b> The ratio between the size of the civilian labor force
                                        and the overall population 16 years of age and older. People in
                                        the labor force are those who are employed or are actively
                                        seeking work.</i></h5>
              <p>The labor force participation rate measures the supply side of the
                 labor market, including both those currently working and those
                 seeking work.</p>
              <p>It is particularly useful in detecting discouraged
                 unemployed workers during economic down turns and in areas that
                 are economically depressed. Higher rates of labor force participation
                 are generally viewed favorably</p>
              <p>Use caution interpreting labor force
                 participation at the local level because income types and population age
                 structure can be confounding factors.</p>
            </section>

            <section data-scene="jobgrowth">
              <h2>Job Growth</h2>
              <h5><i><b>Definition:</b>The net change in the estimated number of full-time
                                       and part-time jobs being performed between the listed year and
                                       the year prior, per 1,000 residents in the county. </i> </h5>
              <p>Job growth focuses on the change in the number of jobs worked. It does
                 not provide perspective on unfilled or vacant jobs potentially available
                in communities.</p>
              <p>ob growth serves as an essential measure of economic
                 vitality and tracks closely with productivity. Taken in combination
                 with unemployment and labor force participation rate, net job growth
                 provides valuable insights on the overall labor market in a given county
                 and across the state.</p>
            </section>

            <section data-scene="end" data-background="img/mthood.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">For more infromation about Oregon and its counties visit:</h1>
                    <h4 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a>
                    </h4>
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn"
               href="https://facebook.com/sharer.php?u=http://benjiantolin.github.io/oregon_keymeasures_dashboard/index.html"
               target="_blank"></a>
        </dt>
        <dt>
            <!--github icon-->
            <a class="fab fa-github btn" href="https://github.com/benjiantolin/oregon_keymeasures_dashboard" style="top:40px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:60px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                  <p>This is a story map that contains a sample of key measures borrowed from the <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a> report.
                    <br><br>
                    A handful of the key measures provided in the report are further visualize the data using a
                    dynamic online interface. The goal of report is to get information to local community leaders, to
                    encorage data driven decision making.
                    <br><br>
                    This story map further extends the vision by creating an online interactive platform to visualize and analyze the key measures for Oregon counties.</p>
                  <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                  <p><b>Author: Benjamin Antolin</b>| Oregon State University
                  </p>
                  <p>The <a href="https://youtu.be/V2vwFS8ae2I">background video</a> on the front page
                      was clipped from Youtube. </p>
                  <p>The context and data about key measures was collected from the Oregon by the Numbers 2018 Edition Report.</p>
                  <p>The favicon image was acquired from <a href="https://en.wikipedia.org/wiki/List_of_Oregon_state_symbols">Wikipedia</a></p>
                  <p>This story map uses geospatial data from cartodb and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">

    //////////////////////////////////////////////////////////////////////////
var colors = chroma.scale('Greens').colors(5);

    // Scene 2: Median Income Choropleth
    // Set function for color ramp
    function setColor1(density){
        //Tenary operation: condition ? valueIfTrue : valueIfFalse
        // condition ? value1 : value2
        var id = 0;
        if (density > 57450) { id = 4; }
        else if (density > 49288 && density <= 57450) { id = 3; }
        else if (density > 42350 &&  density <= 49288) { id = 2; }
        else if (density > 34720 && density <= 42350) { id = 1; }
        else  { id = 0; }
        return colors[id];
    }

    // Set style function that sets fill color property equal to Total Population
    function style1(feature) {
        return {
            fillColor: setColor1(feature.properties.medinc),
            fillOpacity: 0.5,
            weight: 2,
            opacity: 0.8,
            color: '#605f5f',
            dashArray: '4'
        };
    }

    var counties_medinc = L.geoJson.ajax('assets/counties.geojson',
        {
            style: style1,
            onEachFeature: function (feature, layer) {
                layer.bindTooltip(feature.properties.NAME+"<br> Median Income: $"+ feature.properties.medinc , {className: 'feature-label', permanent: false, direction: 'center'});
            }
        });


    var counties_medinc_legend = '<p><b>Median Income ($)</b></p>' +
        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>57,450</b></p>' +
        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>49,288-57,450</b></p>' +
        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>42,350-49,288</b></p>' +
        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>34,721-42,349</b></p>' +
        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><34,720</b></p>';



        //////////////////////////////////////////////////////////////////////////
        // Scene 3: Unemployment Rate

        // Set function for color ramp
        function setColor2(density){
            //Tenary operation: condition ? valueIfTrue : valueIfFalse
            // condition ? value1 : value2
            var id = 0;
            if (density > 7) { id = 4; }
            else if (density > 5.9 && density <= 7) { id = 3; }
            else if (density > 5.1 &&  density <= 5.9) { id = 2; }
            else if (density > 4.4 && density <= 5.1) { id = 1; }
            else  { id = 0; }
            return colors[id];
        }
        // Set style function that sets fill color property equal to percentage of rural population
        function style2(feature) {
            return {
                fillColor: setColor2(feature.properties.unemprate),
                fillOpacity: 0.5,
                weight: 2,
                opacity: 0.8,
                color: '#605f5f',
                dashArray: '4'
            };
        }

        var counties_unemprate = L.geoJson.ajax('assets/counties.geojson',
            {
                style: style2,
                onEachFeature: function (feature, layer) {
                    layer.bindTooltip(feature.properties.NAME+"<br> Unemployment Rate: "+ (feature.properties.unemprate)+"%", {className: 'feature-label', permanent: false, direction: 'center'});
                }
            });


        var counties_unemprate_legend = '<p><b>Unemployment Rate</b></p>' +
            '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>7</b></p>' +
            '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>5.9-7</b></p>' +
            '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>5.1-5.8</b></p>' +
            '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>4.4-5</b></p>' +
            '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><4.4</b></p>';

            //////////////////////////////////////////////////////////////////////////
            // Scene 4: LFPR

            // Set function for color ramp
            function setColor3(density){
                //Tenary operation: condition ? valueIfTrue : valueIfFalse
                // condition ? value1 : value2
                var id = 0;
                if (density > 62.82) { id = 4; }
                else if (density > 58.42 && density <= 62.82) { id = 3; }
                else if (density > 54.4 &&  density <= 58.42) { id = 2; }
                else if (density > 50.29 && density <= 54.4) { id = 1; }
                else  { id = 0; }
                return colors[id];
            }

            // Set style function that sets fill color property equal to net migration
            function style3(feature) {
                return {
                    fillColor: setColor3(feature.properties.lfpr),
                    fillOpacity: 0.5,
                    weight: 2,
                    opacity: 0.8,
                    color: '#605f5f',
                    dashArray: '4'
                };
            }

            var counties_lfpr = L.geoJson.ajax('assets/counties.geojson',
                {
                    style: style3,
                    onEachFeature: function (feature, layer) {
                        layer.bindTooltip(feature.properties.NAME+"<br> Rate: "+ (feature.properties.lfpr).toFixed(2) +"%", {className: 'feature-label', permanent: false, direction: 'center'});
                    }
                });


            var counties_lfpr_legend = '<p><b>Labor Force Particitpation Rate</b></p>' +
                '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>62.82</b></p>' +
                '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>58.42-62.82</b></p>' +
                '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>54.4-58.41</b></p>' +
                '<i style="background:' + colors[1] + '; opacity: 0.5"></i><p><b>50.29-54.3</b></p>'+
                '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><50.28</b></p>';

                // Scene 5: Job Growth


                    // Set function for color ramp
                    function setColor4(density){
                        //Tenary operation: condition ? valueIfTrue : valueIfFalse
                        // condition ? value1 : value2
                        var id = 0;
                        if (density > 18.4) { id = 4; }
                        else if (density > 8.75 && density <= 18.4) { id = 3; }
                        else if (density > .97 &&  density <= 8.75) { id = 2; }
                        else if (density > -19.58 && density <= .97) { id = 1; }
                        else  { id = 0; }
                        return colors[id];
                    }

                    // Set style function that sets fill color property equal to the housing cost burden
                    function style4(feature) {
                        return {
                            fillColor: setColor4(feature.properties.jobgrowth),
                            fillOpacity: 0.5,
                            weight: 2,
                            opacity: 0.8,
                            color: '#605f5f',
                            dashArray: '4'
                        };
                    }

                    var counties_jobgrowth = L.geoJson.ajax('assets/counties.geojson',
                        {
                            style: style4,
                            onEachFeature: function (feature, layer) {
                                layer.bindTooltip(feature.properties.NAME+"<br> Job Growth Per 1000 Captia: "+ (feature.properties.jobgrowth).toFixed(2), {className: 'feature-label', permanent: false, direction: 'center'});
                            }
                        });


                    var counties_jobgrowth_legend = '<p><b>Job Growth</b></p>' +
                        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>18.4</b></p>' +
                        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>8.75-18.4</b></p>' +
                        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>.97-8.74</b></p>' +
                        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>-19.58-.96</b></p>'+
                        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><-19.57</b></p>';

                //////////////////////////////////////////////////////////////////////////


    var layers = {
        ESRI: {layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}')},
        counties_medinc: {
            layer: counties_medinc, legend: counties_medinc_legend
        },
        counties_unemprate: {
            layer: counties_unemprate, legend: counties_unemprate_legend
        },
        counties_lfpr: {
            layer: counties_lfpr, legend: counties_lfpr_legend
        },
        counties_jobgrowth: {
            layer: counties_jobgrowth, legend: counties_jobgrowth_legend
        },
        GEE: {
            layer: L.tileLayer('http://earthengine.google.org/static/hansen_2013/tree_alpha/{z}/{x}/{y}.png'),

        },
        satellite: {
            layer: L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamFrb2J6aGFvIiwiYSI6ImNpcms2YWsyMzAwMmtmbG5icTFxZ3ZkdncifQ.P9MBej1xacybKcDN_jehvw', {
                id: 'mapbox.satellite'
            })
        },
        cartodb_light: {layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png')}
    };

    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        medinc: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Median Income', layers: [layers.counties_medinc]},
        unemprate: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Unemployment Rate', layers: [layers.counties_unemprate]},
        lfpr: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Labor Force Participation Rate', layers: [layers.counties_lfpr]},
        jobgrowth: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Job Growth', layers: [layers.counties_jobgrowth]},
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'The End'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.cartodb_light,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "Data & Content: Oregon by the Numbers 2018 | Basemap: CartoDB &copy; | Video: Morissey Productions | Created by Benji Antolin |",
        loader: true,
        scalebar: false,
        flyo: true,
        navwidget: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);

            //add an miniglobe
            new L.Control.GlobeMiniMap({
                marker: 'red',
                position: 'bottomright'
            }).addTo(map);


            return map;
        }
    });
</script>
</body>
</html>
