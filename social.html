<!DOCTYPE html>
<html lang="en">
<head>
    <title>ObtC Social Measures</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--meta data for sharing links on Facebook-->
    <meta property="og:title" content="Oregon by the Counties"/>
    <meta property="og:url" content="http://benjiantolin.github.io/oregon_keymeasures_dashboard/index.html"/>
    <meta property="og:description" content="This is a storymap using sample measures from Oregon by the Numbers."/>


    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">


    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/oregon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo|Lato" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">
    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--chroma.js-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/globeminimap.js"></script>

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>
</head>
<body>

<div id="storymap" class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="assets/oregon_scenery.mp4">
                <div class="fullscreen text-center">
                  <div class="row justify-content-center align-items-center">
                    <span style="font-size: 2rem;">
                      <a href="index.html"><i class="fas fa-home"></i></a>
                      <a href="demographic.html"><i class="fas fa-users"></i></a>
                      <a href="social.html"><i class="fas fa-shopping-basket"></i></a>
                      <a href="economic.html"><i class="fas fa-chart-line"></i></a>
                      <a href="education.html"><i class="fas fa-user-graduate"></i></a>
                      <a href="health.html"><i class="fas fa-medkit"></i></a>
                      <a href="infrastructure.html"><i class="fas fa-road"></i></a>
                  </span>
                  </div>
                    <h1 class="display-4 d-flex justify-content-center">Social Measures</h1>
                    <h3 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <i>Oregon by the Counties</i>
                    </h3>
                </div>
            </section>
            <section data-scene="foodinsec">
              <h2>Food Insecurity</h2>
              <h5><i><b>Definition:</b> The estimated percentage of individuals who have
                                        limited or uncertain access to adequate food. </i></h5>
              <p>Food insecurity has profound negative impacts on the well-being
                 and success of individuals, families and communities. It is one way
                to represent households at social and economic risk.</P>
              <p>Because there are no direct measures of food insecurity available at
                 the county level, researchers for Feeding America develop an estimate using a
                 mathematical model that combines food security data from the Current
                 Population Survey with other household demographic and economic
                 information. </p>
              <p>Food-secure households have consistent access to safe and
                 nutritional foods without needing to resort to emergency food sources,
                 scavenging, stealing or other coping strategies.
              </p>
            </section>

            <section data-scene="proptax">
              <h2>Property Tax per Person</h2>
              <h5><i><b>Definition:</b> The per-capita property tax imposed, calculated as the
                                        total property tax imposed divided by the number of people in
                                        the county.</i></h5>
              <p> Property tax serves as an important source of revenue for local
                 governments. Per-capita property tax is an indicator of the capacity of
                 local government to provide services such as public safety, roads and
                 other infrastructure, parks/recreation, and public health.</p>
              <p>It is also a
                 measure of relative tax burden. Property tax imposed excludes taxes
                 allocated to urban renewal agencies and special assessments.</p>
            </section>

            <section data-scene="hcb">
              <h2>Housing Cost Burden</h2>
              <h5><i><b>Definition:</b> The percentage of households, both renters and owners, paying 30% or greater of their income on rent or mortgage.</i> </h5>
              <p>Housing cost burden provides a measure of a county’s affordability. The
                 Department of Housing and Urban Development (HUD) has established
                 the “30 percent rule,” meaning that households should spend no more
                 than 30 percent of their income on housing.</p>
              <p>Some criticize the rule
                 for being oversimplified. For example, it does not take into account
                 income level. Still, housing cost burden provides a measure of the
                 number of households that may be at risk of eviction, foreclosure,
                 and/or homelessness.</p>
              <p>This measure is a key success indicator for
                 affordable housing efforts. Those facing housing cost burden also may
                 face challenges spending money in other domains, including food,
                 transportation, health or education.</p>
            </section>

            <section data-scene="childpov">
              <h2>Child Poverty</h2>
              <h5><i><b>Definition:</b> The child poverty rate is the percentage of
                                        individuals in a county under 18 years of age and living in
                                        families whose income falls below the poverty line for their
                                        family size.</p>
              <p>Child poverty is a key predictor of negative social outcomes and
                 increased demand for government services. Poverty can limit
                 a child’s social, educational and personal development due to
                 reduced access to opportunities. </p>
              <p>Children experiencing poverty
                 are less likely to be successful in school, are more likely to have
                 negative health outcomes, have greater difficulty accessing the job
                 market later in life, and are more likely to commit crimes, resulting
                 in a greater demand for services overall. High rates of child poverty
                 can limit community progress.</p>
            </section>

            <section data-scene="childabuse">
              <h2>Child Abuse</h2>
              <h5><i><b>Definition:</b>The number of children in a county who were victims of
                                       child abuse or neglect per 1,000 in the population under 18 years
                                       of age. </p>
              <p>Child abuse is a serious problem in our country. Among industrialized
                 nations, the United States has one of the highest rates of child death
                 by abuse. Child abuse negatively affects the wellbeing of young people
                 in our communities now and in the long run.</p>
              <p>Experiencing abuse
                 as a child contributes to poor physical and mental health well into
                 adulthood. The compounding costs of medical care, lost productivity,
                 child welfare services, criminal justice and specialized education
                 services all place an additional burden on counties — above and
                 beyond the human suffering associated with child abuse.
                 Community economic stress can contribute to rates of child abuse,
                 creating a vicious cycle.</p>
            </section>

            <section data-scene="crime">
              <h2>Index Crime</h2>
              <h5><i><b>Definition:</b>The annual number of index crime offenses per
                                       1,000 residents in a county. Index crimes include willful murder,
                                       forcible rape, robbery, aggravated assault, burglary, theft
                                       and arson.</p>
              <p>Crime rates are a measure of the relative safety of an area, but
                 crime also has important social and economic influences on
                 communities. High rates of crime are associated with population
                 mobility, weaker attachment of residents to their community, less
                 local involvement and lower home values.</p>
              <p>The index crime rate is
                 created to provide a standard measure of particularly important
                 crimes against people and property across the United States.
                 Tracking crime supports law enforcement operations, public safety
                 budgeting and local community development efforts.</p>
            </section>

            <section data-scene="vote">
              <h2>Voter Participation</h2>
              <h5><i><b>Definition:</b>The percentage of registered voters who participated in
                                       biennial general elections.</p>
              <p>Voter participation has long served as a secondary measure of social
                 capital. The relationship between voting and social connections has
                 been heavily researched with little consensus. In the absence of an
                 alternative measure, voter participation continues as an important
                 proxy for civic engagement and community social capital.</p>
              <p>This in turn
                 reflects community capacity. The state of Oregon has implemented
                 multiple policies over the years to increase voter participation, such as
                 mail-in ballots and automatic voter registration. The state reports some
                 of the highest voter participation rates in the country</p>
            </section>


            <section data-scene="end" data-background="img/mthood.jpg">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">For more infromation about Oregon and its counties visit:</h1>
                    <h4 class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">
                      <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a>
                    </h4>
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>

    <dl>
        <dt>
            <!--facebook icon-->
            <a class="fab fa-facebook-square btn"
               href="https://facebook.com/sharer.php?u=https://github.com/benjiantolin/oregon_keymeasures_dashboard/index.html"
               target="_blank"></a>
        </dt>
        <dt>
            <!--github icon-->
            <a class="fab fa-github btn" href="https://github.com/benjiantolin/oregon_keymeasures_dashboard" style="top:40px"
               target="_blank"></a>
        </dt>
        <dt>
            <!--info icon-->
            <i class="fas fa-info-circle btn" style="top:60px" data-toggle="modal" data-target="#info-modal"></i>
        </dt>
    </dl>

    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                  <p>This is a story map that contains a sample of key measures borrowed from the <a href="https://www.tfff.org/select-books/book/oregon-numbers">Oregon by the Numbers 2018 Edition</a> report.
                    <br><br>
                    A handful of the key measures provided in the report are further visualize the data using a
                    dynamic online interface. The goal of report is to get information to local community leaders, to
                    encorage data driven decision making.
                    <br><br>
                    This story map further extends the vision by creating an online interactive platform to visualize and analyze the key measures for Oregon counties.</p>
                  <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                  <p><b>Author: Benjamin Antolin</b>| Oregon State University
                  </p>
                  <p>The <a href="https://youtu.be/V2vwFS8ae2I">background video</a> on the front page
                      is by Morissey Producations and was clipped from Youtube. </p>
                  <p>The context and data about key measures was collected from the Oregon by the Numbers 2018 Edition Report.</p>
                  <p>The favicon image was acquired from <a href="https://en.wikipedia.org/wiki/List_of_Oregon_state_symbols">Wikipedia</a></p>
                  <p>This story map uses geospatial data from cartodb and Oregon Explorer.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">


var colors = chroma.scale('Blues').colors(5);
    //////////////////////////////////////////////////////////////////////////
    // Scene 2: Food Insecurity Choropleth
    // Set function for color ramp
    function setColor1(density){
        //Tenary operation: condition ? valueIfTrue : valueIfFalse
        // condition ? value1 : value2
        var id = 0;
        if (density > 15.71) { id = 4; }
        else if (density > 14.62 && density <= 15.71) { id = 3; }
        else if (density > 12.92 &&  density <= 14.62) { id = 2; }
        else if (density > 8.82 && density <= 12.92) { id = 1; }
        else  { id = 0; }
        return colors[id];
    }

    // Set style function that sets fill color property equal to Total Population
    function style1(feature) {
        return {
            fillColor: setColor1(feature.properties.foodinsec),
            fillOpacity: 0.5,
            weight: 2,
            opacity: 0.8,
            color: '#605f5f',
            dashArray: '4'
        };
    }

    var counties_foodinsec = L.geoJson.ajax('assets/counties.geojson',
        {
            style: style1,
            onEachFeature: function (feature, layer) {
                layer.bindTooltip(feature.properties.NAME+"<br> Food Insecurity: "+ feature.properties.foodinsec+"%" , {className: 'feature-label', permanent: false, direction: 'center'});
            }
        });


    var counties_foodinsec_legend = '<p><b>Food Insecurity (%)</b></p>' +
        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>15.71</b></p>' +
        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>14.62-15.71</b></p>' +
        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>12.92-14.61</b></p>' +
        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>8.82-12.91</b></p>' +
        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><8.81</b></p>';



        //////////////////////////////////////////////////////////////////////////
        // Scene 3: Property tax per capita

        // Set function for color ramp
        function setColor2(density){
            //Tenary operation: condition ? valueIfTrue : valueIfFalse
            // condition ? value1 : value2
            var id = 0;
            if (density > 2707.55) { id = 4; }
            else if (density > 2035.13 && density <= 2707.55) { id = 3; }
            else if (density > 1358.22 &&  density <= 2035.13) { id = 2; }
            else if (density > 1028.84 && density <= 1358.22) { id = 1; }
            else  { id = 0; }
            return colors[id];
        }


        // Set style function that sets fill color property equal to percentage of rural population
        function style2(feature) {
            return {
                fillColor: setColor2(feature.properties.proptax),
                fillOpacity: 0.5,
                weight: 2,
                opacity: 0.8,
                color: '#605f5f',
                dashArray: '4'
            };
        }

        var counties_proptax = L.geoJson.ajax('assets/counties.geojson',
            {
                style: style2,
                onEachFeature: function (feature, layer) {
                    layer.bindTooltip(feature.properties.NAME+"<br> Property Tax: "+"$"+(feature.properties.proptax).toFixed(2), {className: 'feature-label', permanent: false, direction: 'center'});
                }
            });


        var counties_proptax_legend = '<p><b>Property Tax per Capita</b></p>' +
        '<i style="background: ' + colors[4] + '; opacity: 0.5"></i><p><b>>2707.55</b></p>' +
        '<i style="background: ' + colors[3] + '; opacity: 0.5"></i><p><b>2035.13-2707.55</b></p>' +
        '<i style="background: ' + colors[2] + '; opacity: 0.5"></i><p><b>1358.22-2035.12</b></p>' +
        '<i style="background: ' + colors[1] + '; opacity: 0.5"></i><p><b>1028.84-1358.21</b></p>' +
        '<i style="background: ' + colors[0] + '; opacity: 0.5"></i><p><b><1028.83</b></p>';

            //////////////////////////////////////////////////////////////////////////
            // Scene 4: Housing Cost Burden

            // Set function for color ramp
            function setColor3(density){
                //Tenary operation: condition ? valueIfTrue : valueIfFalse
                // condition ? value1 : value2
                var id = 0;
                if (density > 38.12) { id = 4; }
                else if (density > 34.57 && density <= 38.12) { id = 3; }
                else if (density > 31.18 &&  density <= 34.57) { id = 2; }
                else if (density > 26.79 && density <= 31.18) { id = 1; }
                else  { id = 0; }
                return colors[id];
            }

            // Set style function that sets fill color property equal to net migration
            function style3(feature) {
                return {
                    fillColor: setColor3(feature.properties.hcb),
                    fillOpacity: 0.5,
                    weight: 2,
                    opacity: 0.8,
                    color: '#605f5f',
                    dashArray: '4'
                };
            }

            var counties_hcb = L.geoJson.ajax('assets/counties.geojson',
                {
                    style: style3,
                    onEachFeature: function (feature, layer) {
                        layer.bindTooltip(feature.properties.NAME+"<br> Housing Cost Burden: "+ (feature.properties.hcb).toFixed(2)+"%", {className: 'feature-label', permanent: false, direction: 'center'});
                    }
                });


            var counties_hcb_legend = '<p><b>Housing Cost Burden</b></p>' +
                '<i style="background: '+colors[4]+'; opacity: 0.5"></i><p><b>>38.12</b></p>' +
                '<i style="background: '+colors[3]+'; opacity: 0.5"></i><p><b>34.57-38.12</b></p>' +
                '<i style="background: '+colors[2]+'; opacity: 0.5"></i><p><b>31.18-34.56</b></p>' +
                '<i style="background: '+colors[1]+'; opacity: 0.5"></i><p><b>26.79-31.17</b></p>'+
                '<i style="background: '+colors[0]+'; opacity: 0.5"></i><p><b><26.78</b></p>';

      //////////////////////////////////////////////////////////////////////////
                // Scene 5: Child Poverty


                    // Set function for color ramp
                    function setColor4(density){
                        //Tenary operation: condition ? valueIfTrue : valueIfFalse
                        // condition ? value1 : value2
                        var id = 0;
                        if (density > 29.92) { id = 4; }
                        else if (density > 23.95 && density <= 29.92) { id = 3; }
                        else if (density > 19.23 &&  density <= 23.95) { id = 2; }
                        else if (density > 10.99 && density <= 19.23) { id = 1; }
                        else  { id = 0; }
                        return colors[id];
                    }
                    // Set style function that sets fill color property equal to the housing cost burden
                    function style4(feature) {
                        return {
                            fillColor: setColor4(feature.properties.childpov),
                            fillOpacity: 0.5,
                            weight: 2,
                            opacity: 0.8,
                            color: '#605f5f',
                            dashArray: '4'
                        };
                    }

                    var counties_childpov = L.geoJson.ajax('assets/counties.geojson',
                        {
                            style: style4,
                            onEachFeature: function (feature, layer) {
                                layer.bindTooltip(feature.properties.NAME+"<br> Child Poverty Rate: "+ (feature.properties.childpov).toFixed(2)+ "%", {className: 'feature-label', permanent: false, direction: 'center'});
                            }
                        });


                    var counties_childpov_legend = '<p><b>Child Poverty Rate (%)</b></p>' +
                        '<i style="background: '+colors[4]+'; opacity: 0.5"></i><p><b>>29.92</b></p>' +
                        '<i style="background: '+colors[3]+'; opacity: 0.5"></i><p><b>23.95-29.92</b></p>' +
                        '<i style="background: '+colors[2]+'; opacity: 0.5"></i><p><b>19.23-23.94</b></p>' +
                        '<i style="background: '+colors[1]+'; opacity: 0.5"></i><p><b>10.99-19.22</b></p>'+
                        '<i style="background: '+colors[0]+'; opacity: 0.5"></i><p><b><10.98</b></p>';

                //////////////////////////////////////////////////////////////////////////
                          // Scene 6: Child Abuse


                              // Set function for color ramp
                              function setColor5(density){
                                  //Tenary operation: condition ? valueIfTrue : valueIfFalse
                                  // condition ? value1 : value2
                                  var id = 0;
                                  if (density > 35.04) { id = 4; }
                                  else if (density > 25.79 && density <= 35.04) { id = 3; }
                                  else if (density > 16.33 &&  density <= 25.79) { id = 2; }
                                  else if (density > 9.11 && density <= 16.33) { id = 1; }
                                  else  { id = 0; }
                                  return colors[id];
                              }

                              // Set style function that sets fill color property equal to the housing cost burden
                              function style5(feature) {
                                  return {
                                      fillColor: setColor5(feature.properties.childabuse),
                                      fillOpacity: 0.5,
                                      weight: 2,
                                      opacity: 0.8,
                                      color: '#605f5f',
                                      dashArray: '4'
                                  };
                              }

                              var counties_childabuse = L.geoJson.ajax('assets/counties.geojson',
                                  {
                                      style: style5,
                                      onEachFeature: function (feature, layer) {
                                          layer.bindTooltip(feature.properties.NAME+"<br> Child Abuse: "+ (feature.properties.childabuse).toFixed(2), {className: 'feature-label', permanent: false, direction: 'center'});
                                      }
                                  });


                              var counties_childabuse_legend = '<p><b>Child Abuse per 1000 Capita</b></p>' +
                                  '<i style="background: '+colors[4]+'; opacity: 0.5"></i><p><b>>35.04</b></p>' +
                                  '<i style="background: '+colors[3]+'; opacity: 0.5"></i><p><b>25.79-35.04</b></p>' +
                                  '<i style="background: '+colors[2]+'; opacity: 0.5"></i><p><b>16.33-25.78</b></p>' +
                                  '<i style="background: '+colors[1]+'; opacity: 0.5"></i><p><b>9.11-16.32</b></p>'+
                                  '<i style="background: '+colors[0]+'; opacity: 0.5"></i><p><b><9.1</b></p>';

                          //////////////////////////////////////////////////////////////////////////
                          // Scene 7: Index Crime


                              // Set function for color ramp
                              function setColor6(density){
                                  //Tenary operation: condition ? valueIfTrue : valueIfFalse
                                  // condition ? value1 : value2
                                  var id = 0;
                                  if (density > 36.05) { id = 4; }
                                  else if (density > 25.16 && density <= 36.05) { id = 3; }
                                  else if (density > 17.32 &&  density <= 25.16) { id = 2; }
                                  else if (density > 7.01 && density <= 17.32) { id = 1; }
                                  else  { id = 0; }
                                  return colors[id];
                              }

                              // Set style function that sets fill color property equal to the housing cost burden
                              function style6(feature) {
                                  return {
                                      fillColor: setColor6(feature.properties.crime),
                                      fillOpacity: 0.5,
                                      weight: 2,
                                      opacity: 0.8,
                                      color: '#605f5f',
                                      dashArray: '4'
                                  };
                              }

                              var counties_crime = L.geoJson.ajax('assets/counties.geojson',
                                  {
                                      style: style6,
                                      onEachFeature: function (feature, layer) {
                                          layer.bindTooltip(feature.properties.NAME+"<br> Index Crime: "+ (feature.properties.crime).toFixed(2), {className: 'feature-label', permanent: false, direction: 'center'});
                                      }
                                  });


                              var counties_crime_legend = '<p><b>Index Crime per 1000 Capita</b></p>' +
                                  '<i style="background: '+colors[4]+'; opacity: 0.5"></i><p><b>>36.05</b></p>' +
                                  '<i style="background: '+colors[3]+'; opacity: 0.5"></i><p><b>25.16-36.05</b></p>' +
                                  '<i style="background: '+colors[2]+'; opacity: 0.5"></i><p><b>17.32-25.15</b></p>' +
                                  '<i style="background: '+colors[1]+'; opacity: 0.5"></i><p><b>7.01-17.31</b></p>'+
                                  '<i style="background: '+colors[0]+'; opacity: 0.5"></i><p><b><7</b></p>';

                          //////////////////////////////////////////////////////////////////////////

                          // Scene 8: Voter Participation


                              // Set function for color ramp
                              function setColor7(density){
                                  //Tenary operation: condition ? valueIfTrue : valueIfFalse
                                  // condition ? value1 : value2
                                  var id = 0;
                                  if (density > 84.51) { id = 4; }
                                  else if (density > 81.82 && density <= 84.51) { id = 3; }
                                  else if (density > 79.92 &&  density <= 81.82) { id = 2; }
                                  else if (density > 73.4 && density <= 79.92) { id = 1; }
                                  else  { id = 0; }
                                  return colors[id];
                              }

                              // Set style function that sets fill color property equal to the housing cost burden
                              function style7(feature) {
                                  return {
                                      fillColor: setColor7(feature.properties.vote),
                                      fillOpacity: 0.5,
                                      weight: 2,
                                      opacity: 0.8,
                                      color: '#605f5f',
                                      dashArray: '4'
                                  };
                              }

                              var counties_vote = L.geoJson.ajax('assets/counties.geojson',
                                  {
                                      style: style7,
                                      onEachFeature: function (feature, layer) {
                                          layer.bindTooltip(feature.properties.NAME+"<br> Voter Participation Rate: "+ (feature.properties.vote).toFixed(2)+ "%", {className: 'feature-label', permanent: false, direction: 'center'});
                                      }
                                  });


                              var counties_vote_legend = '<p><b>Voter Participation Rate (%)</b></p>' +
                                  '<i style="background: '+colors[4]+'; opacity: 0.5"></i><p><b>>84.51</b></p>' +
                                  '<i style="background: '+colors[3]+'; opacity: 0.5"></i><p><b>81.82-84.51</b></p>' +
                                  '<i style="background: '+colors[2]+'; opacity: 0.5"></i><p><b>79.92-81.81</b></p>' +
                                  '<i style="background: '+colors[1]+'; opacity: 0.5"></i><p><b>73.4-79.91</b></p>'+
                                  '<i style="background: '+colors[0]+'; opacity: 0.5"></i><p><b><73.3</b></p>';

                          //////////////////////////////////////////////////////////////////////////

    var layers = {
        //base layer
        cartodb_light: {layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png')},

        //scene layers
        counties_foodinsec: {
            layer: counties_foodinsec, legend: counties_foodinsec_legend
        },
        counties_proptax: {
            layer: counties_proptax, legend: counties_proptax_legend
        },
        counties_hcb: {
            layer: counties_hcb, legend: counties_hcb_legend
        },
        counties_childpov: {
            layer: counties_childpov, legend: counties_childpov_legend
        },
        counties_childabuse: {
            layer: counties_childabuse, legend: counties_childabuse_legend
        },
        counties_crime: {
            layer: counties_crime, legend: counties_crime_legend
        },
        counties_vote: {
            layer: counties_vote, legend: counties_vote_legend
        }
        }

        //basemap layer
        ;

    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        foodinsec: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Food Insecurity', layers: [layers.counties_foodinsec]},
        proptax: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Property Tax', layers: [layers.counties_proptax]},
        hcb: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Housing Burden Cost', layers: [layers.counties_hcb]},
        childpov: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Child Poverty', layers: [layers.counties_childpov]},
        childabuse: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Child Abuse', layers: [layers.counties_childabuse]},
        crime: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Index Crime', layers: [layers.counties_crime]},
        vote: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Voter Participation', layers: [layers.counties_vote]},
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'The End'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.cartodb_light,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "Data & Content: Oregon by the Numbers 2018 | Basemap: CartoDB &copy; | Video: Morissey Productions | Created by Benji Antolin |",
        loader: true,
        scalebar: false,
        flyo: true,
        navwidget: true,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);

            //add an miniglobe
            new L.Control.GlobeMiniMap({
                marker: 'red',
                position: 'bottomright'
            }).addTo(map);


            return map;
        }
    });
</script>
</body>
</html>
